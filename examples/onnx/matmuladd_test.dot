digraph {
  graph [compound=true];
  X [label=X shape=ellipse color="#00FF00"];
  A [label=A shape=ellipse color="#00FF00"];
  B [label=B shape=ellipse color="#00FF00"];
  reshape_0 [label=Reshape shape=box color="#0000FF"];
  Loop_0 -> reshape_0 [label=""];
  reshape_shape_0 [label=reshape_shape_0 shape=box];
  trip_count_0 [label=trip_count_0 shape=ellipse color="#00FF00"];
  cond_0 [label=cond_0 shape=ellipse color="#00FF00"];
  init_carry [label=init_carry shape=box];
  subgraph cluster_loop_Loop_0 {
    graph [rankdir=LR compound=true];
    loopLoop_0_iter [label=iter shape=ellipse color="#00FF00"];
    loopLoop_0_cond_in [label=cond_in shape=ellipse color="#00FF00"];
    loopLoop_0_carry [label=carry shape=ellipse color="#00FF00"];
    loopLoop_0_axes [label=axes shape=box];
    loopLoop_0_unsq [label=Unsqueeze shape=box color="#0000FF"];
    loopLoop_0_unsq -> loopLoop_0_g_B_1 [label=""];
    loopLoop_0_unsq -> loopLoop_0_scatter [label=""];
    loopLoop_0_N_0 [label=N_0 shape=box];
    loopLoop_0_shape1_0 [label=shape1_0 shape=box];
    loopLoop_0_shapeK_0 [label=shapeK_0 shape=box];
    loopLoop_0_Div_0 [label=Div shape=box color="#0000FF"];
    loopLoop_0_Mod_0 [label=Mod shape=box color="#0000FF"];
    loopLoop_0_rowU_0 [label=Unsqueeze shape=box color="#0000FF"];
    loopLoop_0_colU_0 [label=Unsqueeze shape=box color="#0000FF"];
    loopLoop_0_g_X_0 [label=Gather shape=box color="#0000FF"];
    loopLoop_0_g_A_0 [label=Gather shape=box color="#0000FF"];
    loopLoop_0_reshape_reshapeRow_0 [label=Reshape shape=box color="#0000FF"];
    loopLoop_0_reshape_reshapeCol_0 [label=Reshape shape=box color="#0000FF"];
    loopLoop_0_mul_0 [label=Mul shape=box color="#0000FF"];
    loopLoop_0_reduce_0 [label=ReduceSum shape=box color="#0000FF"];
    loopLoop_0_reshape_0 [label=Reshape shape=box color="#0000FF"];
    loopLoop_0_flat_shape_B [label=flat_shape_B shape=box];
    loopLoop_0_flat_rs_B [label=Reshape shape=box color="#0000FF"];
    loopLoop_0_g_B_1 [label=Gather shape=box color="#0000FF"];
    loopLoop_0_Add_1 [label=Add shape=box color="#0000FF"];
    loopLoop_0_Add_1 -> loopLoop_0_scatter [label=""];
    loopLoop_0_scatter [label=ScatterElements shape=box color="#0000FF"];
    loopLoop_0_id_cond [label=Identity shape=box color="#0000FF"];
    loopLoop_0_cond_out [label=cond_out shape=ellipse color="#FF0000"];
    loopLoop_0_carry_out [label=carry_out shape=ellipse color="#FF0000"];
    loopLoop_0_carry -> loopLoop_0_scatter [label=""];
    loopLoop_0_cond_in -> loopLoop_0_id_cond [label=""];
    loopLoop_0_id_cond -> loopLoop_0_cond_out [label=""];
    loopLoop_0_scatter -> loopLoop_0_carry_out [label="{9}"];
    X -> loopLoop_0_g_X_0 [style=dashed color=gray label=ext];
    A -> loopLoop_0_g_A_0 [style=dashed color=gray label=ext];
    graph [label="Loop Loop_0"];
    graph [style=dashed];
    graph [color=gray];
  }

  Y [label=Y shape=ellipse color="#FF0000"];
  B -> loopLoop_0_Loop_0 [label="{3,3}" lhead=cluster_loop_Loop_0];
  reshape_shape_0 -> reshape_0 [label=""];
  reshape_0 -> Y [label="{3,3}"];
  trip_count_0 -> loopLoop_0_Loop_0 [label="" lhead=cluster_loop_Loop_0];
  cond_0 -> loopLoop_0_Loop_0 [label="" lhead=cluster_loop_Loop_0];
  X -> loopLoop_0_Loop_0 [label="{3,3}" lhead=cluster_loop_Loop_0];
  A -> loopLoop_0_Loop_0 [label="{3,3}" lhead=cluster_loop_Loop_0];
}
