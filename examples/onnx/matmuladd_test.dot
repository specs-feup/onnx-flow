digraph {
  graph [compound=true];
  X [label=X shape=ellipse color="#00FF00"];
  A [label=A shape=ellipse color="#00FF00"];
  B [label=B shape=ellipse color="#00FF00"];
  Y [label=Y shape=ellipse color="#FF0000"];
  Reshape_0 -> Loop_1 [label=""];
  trip_count [label=trip_count shape=ellipse color="#00FF00"];
  cond [label=cond shape=ellipse color="#00FF00"];
  subgraph cluster_loop_Loop_0 {
    graph [rankdir=LR compound=true];
    loopLoop_0_iter_idx [label=iter_idx shape=ellipse color="#00FF00"];
    loopLoop_0_cond_in [label=cond_in shape=ellipse color="#00FF00"];
    loopLoop_0_carry [label=carry shape=box];
    loopLoop_0_X [label=X shape=ellipse color="#00FF00"];
    loopLoop_0_A [label=A shape=ellipse color="#00FF00"];
    loopLoop_0_axes [label=axes shape=box];
    loopLoop_0_idx_unsq [label=Unsqueeze shape=box color="#0000FF"];
    loopLoop_0_shape1 [label=shape1 shape=box];
    loopLoop_0_N [label=N shape=box];
    loopLoop_0_row [label=Div shape=box color="#0000FF"];
    loopLoop_0_col [label=Mod shape=box color="#0000FF"];
    loopLoop_0_rowU [label=Unsqueeze shape=box color="#0000FF"];
    loopLoop_0_colU [label=Unsqueeze shape=box color="#0000FF"];
    loopLoop_0_A_row [label=Gather shape=box color="#0000FF"];
    loopLoop_0_shapeK [label=shapeK shape=box];
    loopLoop_0_A_vec [label=Reshape shape=box color="#0000FF"];
    loopLoop_0_B_col [label=Gather shape=box color="#0000FF"];
    loopLoop_0_B_vec [label=Reshape shape=box color="#0000FF"];
    loopLoop_0_prod [label=Mul shape=box color="#0000FF"];
    loopLoop_0_dot [label=ReduceSum shape=box color="#0000FF"];
    loopLoop_0_dotS [label=Reshape shape=box color="#0000FF"];
    loopLoop_0_scatter [label=ScatterElements shape=box color="#0000FF"];
    loopLoop_0_carry_out [label=carry_out shape=ellipse color="#FF0000"];
    loopLoop_0_id_cond [label=Identity shape=box color="#0000FF"];
    loopLoop_0_cond_out [label=cond_out shape=ellipse color="#FF0000"];
    loopLoop_0_iter_idx -> loopLoop_0_idx_unsq [label=""];
    loopLoop_0_axes -> loopLoop_0_idx_unsq [label=""];
    loopLoop_0_iter_idx -> loopLoop_0_row [label=""];
    loopLoop_0_N -> loopLoop_0_row [label=""];
    loopLoop_0_iter_idx -> loopLoop_0_col [label=""];
    loopLoop_0_N -> loopLoop_0_col [label=""];
    loopLoop_0_row -> loopLoop_0_axes;
    loopLoop_0_row -> loopLoop_0_rowU [label=""];
    loopLoop_0_axes -> loopLoop_0_rowU [label=""];
    loopLoop_0_col -> loopLoop_0_colU [label=""];
    loopLoop_0_axes -> loopLoop_0_colU [label=""];
    loopLoop_0_A_vec -> loopLoop_0_B_vec [label=""];
    loopLoop_0_prod -> loopLoop_0_dot [label=""];
    loopLoop_0_carry -> loopLoop_0_scatter [label=""];
    loopLoop_0_idx_unsq -> loopLoop_0_scatter [label=""];
    loopLoop_0_dotS -> loopLoop_0_scatter [label=""];
    loopLoop_0_scatter -> loopLoop_0_carry_out [label=""];
    loopLoop_0_cond_in -> loopLoop_0_id_cond [label=""];
    loopLoop_0_id_cond -> loopLoop_0_cond_out [label=""];
    graph [label="Loop Loop_0"];
    graph [style=dashed];
    graph [color=gray];
  }

  reshape_shape_0 [label=reshape_shape_0 shape=box];
  Reshape_0 [label=Reshape shape=box color="#0000FF"];
  subgraph cluster_loop_Loop_1 {
    graph [rankdir=LR compound=true];
    loopLoop_1_iter_idx [label=iter_idx shape=ellipse color="#00FF00"];
    loopLoop_1_cond_in [label=cond_in shape=ellipse color="#00FF00"];
    loopLoop_1_carry [label=carry shape=box];
    loopLoop_1_B [label=B shape=ellipse color="#00FF00"];
    loopLoop_1_XA [label=XA shape=ellipse color="#00FF00"];
    loopLoop_1_axes [label=axes shape=box];
    loopLoop_1_idx_unsq [label=Unsqueeze shape=box color="#0000FF"];
    loopLoop_1_g_B [label=Gather shape=box color="#0000FF"];
    loopLoop_1_g_XA [label=Gather shape=box color="#0000FF"];
    loopLoop_1_Add_1 [label=Add shape=box color="#0000FF"];
    loopLoop_1_scatter [label=ScatterElements shape=box color="#0000FF"];
    loopLoop_1_carry_out [label=carry_out shape=ellipse color="#FF0000"];
    loopLoop_1_id_cond [label=Identity shape=box color="#0000FF"];
    loopLoop_1_cond_out [label=cond_out shape=ellipse color="#FF0000"];
    loopLoop_1_iter_idx -> loopLoop_1_idx_unsq [label=""];
    loopLoop_1_axes -> loopLoop_1_idx_unsq [label=""];
    loopLoop_1_carry -> loopLoop_1_scatter [label=""];
    loopLoop_1_idx_unsq -> loopLoop_1_scatter [label=""];
    loopLoop_1_Add_1 -> loopLoop_1_scatter [label=""];
    loopLoop_1_scatter -> loopLoop_1_carry_out [label=""];
    loopLoop_1_cond_in -> loopLoop_1_id_cond [label=""];
    loopLoop_1_id_cond -> loopLoop_1_cond_out [label=""];
    graph [label="Loop Loop_1"];
    graph [style=dashed];
    graph [color=gray];
  }

  loopLoop_0_Loop_0 -> Reshape_0 [label="" ltail=cluster_loop_Loop_0];
  cond -> loopLoop_1_Loop_1 [label="" lhead=cluster_loop_Loop_1];
  reshape_shape_0 -> Reshape_0 [label=""];
  A -> loopLoop_0_Loop_0 [label="{1,3}" lhead=cluster_loop_Loop_0];
  B -> loopLoop_1_Loop_1 [label="{3,3}" lhead=cluster_loop_Loop_1];
  loopLoop_1_Loop_1 -> Y [label="{3,3}" ltail=cluster_loop_Loop_1];
  trip_count -> loopLoop_0_Loop_0 [label="" lhead=cluster_loop_Loop_0];
  cond -> loopLoop_0_Loop_0 [label="" lhead=cluster_loop_Loop_0];
  X -> loopLoop_0_Loop_0 [label="{3,1}" lhead=cluster_loop_Loop_0];
  trip_count -> loopLoop_1_Loop_1 [label="" lhead=cluster_loop_Loop_1];
}
