digraph {
  graph [compound=true rankdir=LR];
  init_carry [label=init_carry shape=box];
  final_shape [label=final_shape shape=box];
  A [label=A shape=ellipse color=lime];
  B [label=B shape=ellipse color=lime];
  trip_count [label=trip_count shape=ellipse color=lime];
  cond [label=cond shape=ellipse color=lime];
  Y [label=Y shape=ellipse color=red];
  subgraph cluster_loop_0 {
    graph [compound=true rankdir=LR];
    loop0_const_N [label=const_N shape=box];
    loop0_axes0 [label=axes0 shape=box];
    loop0_shape_1 [label=shape_1 shape=box];
    loop0_reshape_k [label=reshape_k shape=box];
    loop0_i [label=i shape=ellipse color=lime];
    loop0_cond_in [label=cond_in shape=ellipse color=lime];
    loop0_carry [label=carry shape=ellipse color=lime];
    loop0_cond_out [label=cond_out shape=ellipse color=red];
    loop0_carry_out [label=carry_out shape=ellipse color=red];
    loop0_0 [label=Unsqueeze shape=box color=blue];
    loop0_0 -> loop0_12 [label="{1}"];
    loop0_1 [label=Div shape=box color=blue];
    loop0_1 -> loop0_3 [label=sc];
    loop0_2 [label=Mod shape=box color=blue];
    loop0_2 -> loop0_4 [label=sc];
    loop0_3 [label=Unsqueeze shape=box color=blue];
    loop0_3 -> loop0_5 [label="{1}"];
    loop0_4 [label=Unsqueeze shape=box color=blue];
    loop0_4 -> loop0_7 [label="{1}"];
    loop0_5 [label=Gather shape=box color=blue];
    A -> loop0_5 [label="{2,2}" style=dashed color=gray];
    loop0_5 -> loop0_6 [label="{1,2}"];
    loop0_6 [label=Reshape shape=box color=blue];
    loop0_6 -> loop0_9 [label="{2}"];
    loop0_7 [label=Gather shape=box color=blue];
    B -> loop0_7 [label="{2,2}" style=dashed color=gray];
    loop0_7 -> loop0_8 [label="{1,2}"];
    loop0_8 [label=Reshape shape=box color=blue];
    loop0_8 -> loop0_9 [label="{2}"];
    loop0_9 [label=Mul shape=box color=blue];
    loop0_9 -> loop0_10 [label="{2}"];
    loop0_10 [label=ReduceSum shape=box color=blue];
    loop0_10 -> loop0_11 [label="{1}"];
    loop0_11 [label=Reshape shape=box color=blue];
    loop0_11 -> loop0_12 [label="{1}"];
    loop0_12 [label=ScatterElements shape=box color=blue];
    loop0_13 [label=Identity shape=box color=blue];
    loop0_i -> loop0_0 [label=sc];
    loop0_axes0 -> loop0_0 [label="{1}"];
    loop0_12 -> loop0_carry_out [label="{4}"];
    loop0_i -> loop0_1 [label=sc];
    loop0_const_N -> loop0_1 [label=sc];
    loop0_i -> loop0_2 [label=sc];
    loop0_const_N -> loop0_2 [label=sc];
    loop0_axes0 -> loop0_3 [label="{1}"];
    loop0_axes0 -> loop0_4 [label="{1}"];
    loop0_reshape_k -> loop0_6 [label="{1}"];
    loop0_reshape_k -> loop0_8 [label="{1}"];
    loop0_axes0 -> loop0_10 [label="{1}"];
    loop0_shape_1 -> loop0_11 [label="{1}"];
    loop0_carry -> loop0_12 [label="{4}"];
    loop0_cond_in -> loop0_13 [label=sc];
    loop0_13 -> loop0_cond_out [label=sc];
    A -> loop0_5 [style=dashed color=gray label="{2,2}"];
    B -> loop0_7 [style=dashed color=gray label="{2,2}"];
    graph [label="Loop 0"];
    graph [style=dashed];
    graph [color=gray];
  }

  loop0_0 -> 1 [label="{4}" ltail=cluster_loop_0];
  1 [label=Reshape shape=box color=blue];
  trip_count -> loop0_0 [label=sc lhead=cluster_loop_0];
  cond -> loop0_0 [label=sc lhead=cluster_loop_0];
  init_carry -> loop0_0 [label="{4}" lhead=cluster_loop_0];
  final_shape -> 1 [label="{2}"];
  1 -> Y [label="{2,2}"];
}
