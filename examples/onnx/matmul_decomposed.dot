digraph {
  graph [rankdir=LR compound=true];
  init_carry [label=init_carry shape=box];
  final_shape [label=final_shape shape=box];
  A [label=A shape=ellipse color="#00FF00"];
  B [label=B shape=ellipse color="#00FF00"];
  trip_count [label=trip_count shape=ellipse color="#00FF00"];
  cond [label=cond shape=ellipse color="#00FF00"];
  Y [label=Y shape=ellipse color="#FF0000"];
  0 [label=Loop shape=box color="#0000FF"];
  Y_flat [label=Y_flat shape=box];
  1 [label=Reshape shape=box color="#0000FF"];
  trip_count -> 0 [label=""];
  cond -> 0 [label=""];
  init_carry -> 0 [label="{4}"];
  0 -> Y_flat [label=""];
  Y_flat -> 1 [label=""];
  final_shape -> 1 [label="{2}"];
  1 -> Y [label=""];
  subgraph cluster_loop_0 {
    graph [rankdir=LR compound=true];
    const_N [label=const_N shape=box];
    axes0 [label=axes0 shape=box];
    shape_1 [label=shape_1 shape=box];
    reshape_k [label=reshape_k shape=box];
    i [label=i shape=ellipse color="#00FF00"];
    cond_in [label=cond_in shape=ellipse color="#00FF00"];
    carry [label=carry shape=ellipse color="#00FF00"];
    cond_out [label=cond_out shape=ellipse color="#FF0000"];
    carry_out [label=carry_out shape=ellipse color="#FF0000"];
    0 [label=Unsqueeze shape=box color="#0000FF"];
    idx [label=idx shape=box];
    1 [label=Div shape=box color="#0000FF"];
    row [label=row shape=box];
    2 [label=Mod shape=box color="#0000FF"];
    col [label=col shape=box];
    3 [label=Unsqueeze shape=box color="#0000FF"];
    row_idx [label=row_idx shape=box];
    4 [label=Unsqueeze shape=box color="#0000FF"];
    col_idx [label=col_idx shape=box];
    5 [label=Gather shape=box color="#0000FF"];
    a_row [label=a_row shape=box];
    6 [label=Reshape shape=box color="#0000FF"];
    a_vec [label=a_vec shape=box];
    7 [label=Gather shape=box color="#0000FF"];
    b_col [label=b_col shape=box];
    8 [label=Reshape shape=box color="#0000FF"];
    b_vec [label=b_vec shape=box];
    9 [label=Mul shape=box color="#0000FF"];
    prod [label=prod shape=box];
    10 [label=ReduceSum shape=box color="#0000FF"];
    dot [label=dot shape=box];
    11 [label=Reshape shape=box color="#0000FF"];
    dot_unsqueezed [label=dot_unsqueezed shape=box];
    12 [label=ScatterElements shape=box color="#0000FF"];
    13 [label=Identity shape=box color="#0000FF"];
    i -> 0 [label=""];
    axes0 -> 0 [label="{1}"];
    0 -> idx [label=""];
    i -> 1 [label=""];
    const_N -> 1 [label=""];
    1 -> row [label=""];
    i -> 2 [label=""];
    const_N -> 2 [label=""];
    2 -> col [label=""];
    row -> 3 [label=""];
    axes0 -> 3 [label="{1}"];
    3 -> row_idx [label=""];
    col -> 4 [label=""];
    axes0 -> 4 [label="{1}"];
    4 -> col_idx [label=""];
    row_idx -> 5 [label=""];
    5 -> a_row [label=""];
    a_row -> 6 [label=""];
    reshape_k -> 6 [label="{1}"];
    6 -> a_vec [label=""];
    col_idx -> 7 [label=""];
    7 -> b_col [label=""];
    b_col -> 8 [label=""];
    reshape_k -> 8 [label="{1}"];
    8 -> b_vec [label=""];
    a_vec -> 9 [label=""];
    b_vec -> 9 [label=""];
    9 -> prod [label=""];
    prod -> 10 [label=""];
    axes0 -> 10 [label="{1}"];
    10 -> dot [label=""];
    dot -> 11 [label=""];
    shape_1 -> 11 [label="{1}"];
    11 -> dot_unsqueezed [label=""];
    carry -> 12 [label="{4}"];
    idx -> 12 [label=""];
    dot_unsqueezed -> 12 [label=""];
    12 -> carry_out [label="{4}"];
    cond_in -> 13 [label=""];
    13 -> cond_out [label=""];
    graph [label="Loop 0"];
    graph [style=dashed];
    graph [color=gray];
  }

}
