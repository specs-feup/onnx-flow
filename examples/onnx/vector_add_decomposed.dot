digraph {
  graph [compound=true rankdir=LR];
  init_carry [label=init_carry shape=box];
  trip_count [label=trip_count shape=ellipse color=lime];
  cond [label=cond shape=ellipse color=lime];
  A [label=A shape=ellipse color=lime];
  B [label=B shape=ellipse color=lime];
  final_vec [label=final_vec shape=ellipse color=red];
  subgraph cluster_loop_0 {
    graph [compound=true rankdir=LR];
    loop0_iter_idx [label=iter_idx shape=ellipse color=lime];
    loop0_cond_in [label=cond_in shape=ellipse color=lime];
    loop0_carry [label=carry shape=ellipse color=lime];
    loop0_cond_out [label=cond_out shape=ellipse color=red];
    loop0_carry_out [label=carry_out shape=ellipse color=red];
    loop0_0 [label=Unsqueeze shape=box color=blue];
    loop0_0 -> loop0_1 [label="{1}"];
    loop0_0 -> loop0_2 [label="{1}"];
    loop0_0 -> loop0_4 [label="{1}"];
    loop0_1 [label=Gather shape=box color=blue];
    A -> loop0_1 [label="{4}" style=dashed color=gray];
    loop0_1 -> loop0_3 [label="{1}"];
    loop0_2 [label=Gather shape=box color=blue];
    B -> loop0_2 [label="{4}" style=dashed color=gray];
    loop0_2 -> loop0_3 [label="{1}"];
    loop0_3 [label=Add shape=box color=blue];
    loop0_3 -> loop0_4 [label="{1}"];
    loop0_4 [label=ScatterElements shape=box color=blue];
    loop0_5 [label=Identity shape=box color=blue];
    loop0_iter_idx -> loop0_0 [label=sc];
    loop0_4 -> loop0_carry_out [label="{4}"];
    loop0_carry -> loop0_4 [label="{4}"];
    loop0_cond_in -> loop0_5 [label=sc];
    loop0_5 -> loop0_cond_out [label=sc];
    A -> loop0_1 [style=dashed color=gray label="{4}"];
    B -> loop0_2 [style=dashed color=gray label="{4}"];
    graph [label="Loop 0"];
    graph [style=dashed];
    graph [color=gray];
  }

  trip_count -> loop0_0 [label=sc lhead=cluster_loop_0];
  cond -> loop0_0 [label=sc lhead=cluster_loop_0];
  init_carry -> loop0_0 [label="{4}" lhead=cluster_loop_0];
  loop0_0 -> final_vec [label="{4}" ltail=cluster_loop_0];
}
