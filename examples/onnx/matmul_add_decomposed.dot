digraph {
  graph [compound=true];
  init_carry [label=init_carry shape=box];
  final_shape [label=final_shape shape=box];
  X [label=X shape=ellipse color="#00FF00"];
  A [label=A shape=ellipse color="#00FF00"];
  B [label=B shape=ellipse color="#00FF00"];
  trip_count [label=trip_count shape=ellipse color="#00FF00"];
  cond [label=cond shape=ellipse color="#00FF00"];
  Y [label=Y shape=ellipse color="#FF0000"];
  subgraph cluster_loop_0 {
    graph [rankdir=LR compound=true];
    loop0_axes0 [label=axes0 shape=box];
    loop0_N [label=N shape=box];
    loop0_shape1 [label=shape1 shape=box];
    loop0_i [label=i shape=ellipse color="#00FF00"];
    loop0_cond_in [label=cond_in shape=ellipse color="#00FF00"];
    loop0_carry [label=carry shape=ellipse color="#00FF00"];
    loop0_cond_out [label=cond_out shape=ellipse color="#FF0000"];
    loop0_carry_out [label=carry_out shape=ellipse color="#FF0000"];
    loop0_0 [label=Unsqueeze shape=box color="#0000FF"];
    loop0_0 -> loop0_14 [label=""];
    loop0_1 [label=Div shape=box color="#0000FF"];
    loop0_1 -> loop0_3 [label=""];
    loop0_2 [label=Mod shape=box color="#0000FF"];
    loop0_2 -> loop0_4 [label=""];
    loop0_3 [label=Unsqueeze shape=box color="#0000FF"];
    loop0_3 -> loop0_5 [label=""];
    loop0_3 -> loop0_10 [label=""];
    loop0_4 [label=Unsqueeze shape=box color="#0000FF"];
    loop0_4 -> loop0_7 [label=""];
    loop0_4 -> loop0_11 [label=""];
    loop0_5 [label=Gather shape=box color="#0000FF"];
    loop0_5 -> loop0_6 [label=""];
    loop0_6 [label=Reshape shape=box color="#0000FF"];
    loop0_6 -> loop0_9 [label=""];
    loop0_7 [label=Gather shape=box color="#0000FF"];
    loop0_7 -> loop0_8 [label=""];
    loop0_8 [label=Reshape shape=box color="#0000FF"];
    loop0_8 -> loop0_9 [label=""];
    loop0_9 [label=Mul shape=box color="#0000FF"];
    loop0_9 -> loop0_13 [label=""];
    loop0_10 [label=Gather shape=box color="#0000FF"];
    loop0_10 -> loop0_11 [label=""];
    loop0_11 [label=Gather shape=box color="#0000FF"];
    loop0_11 -> loop0_12 [label=""];
    loop0_12 [label=Reshape shape=box color="#0000FF"];
    loop0_12 -> loop0_13 [label=""];
    loop0_13 [label=Add shape=box color="#0000FF"];
    loop0_13 -> loop0_14 [label=""];
    loop0_14 [label=ScatterElements shape=box color="#0000FF"];
    loop0_15 [label=Identity shape=box color="#0000FF"];
    loop0_i -> loop0_0 [label=""];
    loop0_axes0 -> loop0_0 [label="{1}"];
    loop0_i -> loop0_1 [label=""];
    loop0_N -> loop0_1 [label=""];
    loop0_i -> loop0_2 [label=""];
    loop0_N -> loop0_2 [label=""];
    loop0_axes0 -> loop0_3 [label="{1}"];
    loop0_axes0 -> loop0_4 [label="{1}"];
    loop0_shape1 -> loop0_6 [label="{1}"];
    loop0_shape1 -> loop0_8 [label="{1}"];
    loop0_shape1 -> loop0_12 [label="{1}"];
    loop0_carry -> loop0_14 [label="{9}"];
    loop0_14 -> loop0_carry_out [label="{9}"];
    loop0_cond_in -> loop0_15 [label=""];
    loop0_15 -> loop0_cond_out [label=""];
    X -> loop0_5 [style=dashed color=gray label=ext];
    A -> loop0_7 [style=dashed color=gray label=ext];
    B -> loop0_10 [style=dashed color=gray label=ext];
    graph [label="Loop 0"];
    graph [style=dashed];
    graph [color=gray];
  }

  loop0_0 -> 1 [label="" ltail=cluster_loop_0];
  1 [label=Reshape shape=box color="#0000FF"];
  trip_count -> loop0_0 [label="" lhead=cluster_loop_0];
  cond -> loop0_0 [label="" lhead=cluster_loop_0];
  init_carry -> loop0_0 [label="{9}" lhead=cluster_loop_0];
  final_shape -> 1 [label="{2}"];
  1 -> Y [label="{2}"];
}
